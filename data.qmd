---
title: "Data Portal"
subtitle: "Download the data used to build this web book"
date-modified: last-modified
date-format: "MMM D, YYYY [at] HH:mm"
output:
  quarto::quarto_html:
    pre_processor: quarto::observable
echo: false
---


```{ojs}
// load libraries
stdlib = require("@observablehq/stdlib")
d3 = require("d3@7")

// connect to database
db = FileAttachment("data/working/aetr.db").sqlite()

```


The table and downloadable CSV are rendered directly from the SQLite database!
```{ojs}
// This chunk makes the fancy dropdown database veiwing tool
// 
viewof dbTable = Inputs.select((await db.describe()).value.map(d => d.name), 
                    { label: "Table" })
data = db.query(`SELECT * FROM ${dbTable}`)
Inputs.table(data)

```

```{ojs}

blob = new Blob([d3.csvFormat(data)], {type: "text/csv"})

DOM.download(blob, `${dbTable}`, `Download this table`)


```

